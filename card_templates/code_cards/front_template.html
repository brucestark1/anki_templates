<!-------- Card Content, Hint, Tags & URL -------->
<div class="content_aligned">
    <!------- Content & Hint ------->
    {{Front}}

    <br>
    {{#Hint}}
    <br>

    <div id="hint" class="hidden">
        <p class="trigger">[ click to show hint ]</p>
        <p class="payload">{{Hint}}</p>
    </div>
    {{/Hint}}

</div>



<!------- Tags & URL ------->
<div id="primary-tag-container" style="position: absolute; bottom: 0; left: 11%;">
    <div id="content_tag_left" class="tag primary left"></div>
</div>

<div id="url-container" style="position: absolute; bottom: 0; right: 11%;">
    {{URL}}
</div>



<!-------- JavaScript -------->
<script>
    // store all input values into an object
    function storeInput() {
        const data = {};
        document.querySelectorAll("input").forEach(elem => {
            elem.addEventListener("input", () => { data[elem.name] = elem.value; });
        });
        return data;
    }

    // automatically place cursor onto first input field if it exists
    function placeCursor() {
      const firstElement = document.getElementsByTagName("input")[0];
      if (firstElement) firstElement.focus();
    }

    // attach touch and mouse event listeners to reveal the hint element when triggered
    function setupHint() {
        const hint = document.getElementById("hint");
        if (hint) {
            hint.addEventListener("touchstart", () => hint.className = "shown");
            hint.addEventListener("mousedown", () => hint.className = "shown");
        }
    }

    // parses a space delimited tag string, extracts “content” tags, and displays them in #content_tag_left
    function displayTags(tags) {
        const tagParts = tags.split(" ");
        let content = [];
        tagParts.forEach(tag => {
            const pieces = tag.split("::");
            if (pieces[0] === "content") content = pieces;
        });
        const elem = document.querySelector("#content_tag_left");
        if (elem) elem.textContent = content.join(" - ").replace(/_/g, " ");
    }

    // set link text with similar formatting and colour scheme used in anki for consistent experience
    function setLinkText() {
        const anchor = document.querySelector("a");
        if (anchor) anchor.textContent = "Link";
        anchor.style.fontWeight = "bold";
        anchor.style.color = "#84c7ff"
    }

    window._data = storeInput();
    placeCursor();
    setupHint();
    displayTags("{{Tags}}");
    setLinkText();
</script>
